"use strict";(function(){$.fn.store=function(b){let element=$(this);b=$.extend({},{prefix:"advanced-table",engine:{set:function(f,h,g){try{if(typeof h=="object"||typeof h=="array"){h=JSON.stringify(h)}}catch(e){}window.localStorage.setItem(f,h)},get:function(f){let value=window.localStorage.getItem(f);try{return JSON.parse(value)}catch(e){return value}}}},b);let element_id=b.prefix+"-"+element.prop("id");function d(){if(b.engine.get(element_id)){let data=b.engine.get(element_id);return data}return[]}function a(){let data=[];let cell,id;let children=element.find("thead > tr:first").children();for(let i=0;i<children.length;i++){cell=$(children[i]);id=cell.prop("id");data.push({id:"#"+id,width:cell.find("span:first").width()})}b.engine.set(element_id,data);return element}function c(){b.engine.set(element_id,null);return element}return{load:d,store:a,reset:c}}})();"use strict";(function(){function b(d){let element=$(d.target);let table=element.parents("table");if(element.parents("thead").length&&element.parents("th").length){element=element.parents("th")}if(element.prop("tagName")!="TH"&&element.prop("tagName")!="TD"){return false}if(d.pageX>element.offset().left+element.outerWidth()-5&&d.pageX<=element.offset().left+element.outerWidth()){return true}return false}function a(f,d){let el;let actualIndex=0;let index=f.index();let colspan=f.prop("colspan");let header=f.parents("table").find("thead > tr:first");for(let i=0;i<index;i++){el=header.children().get(i);actualIndex+=Number($(el).prop("colspan"))}let e=header.children().get(index);let headerSpan=$(e).children().get(0);$(headerSpan).css("width",d+"px");f.parents("table").find(":not(thead > tr:first)").each(function(){for(let i=0;i<colspan;i++){let e=$(this).children().get(actualIndex+i);let span=$(e).children().get(0);if($(span).prop("tagName")=="SPAN"&&$(span).hasClass("advanced-table-resizer-span")){$(span).css("width",(d/colspan)+"px")}}})}function c(f,d){let table=f.parents("table");let fromIndex=f.index();let toIndex=d.index();let header=table.find("thead > tr:first");let actualFromIndex=0;let actualToIndex=0;let el;for(let i=0;i<fromIndex;i++){el=header.children().get(i);actualFromIndex+=Number($(el).prop("colspan"))}for(let i=0;i<toIndex;i++){el=header.children().get(i);actualToIndex+=Number($(el).prop("colspan"))}let numberOfColumns=$(f).prop("colspan");let colIndex=0;table.find("tr").each(function(){let eFrom,eTo;if(colIndex==0){eFrom=$(this).children().get(fromIndex);eTo=$(this).children().get(toIndex);$(eFrom).insertBefore($(eTo));colIndex++;return}for(let i=0;i<numberOfColumns;i++){if(fromIndex<toIndex){eFrom=$(this).children().get(actualFromIndex);eTo=$(this).children().get(actualToIndex)}else{eFrom=$(this).children().get(actualFromIndex+i);eTo=$(this).children().get(actualToIndex+i)}$(eFrom).insertBefore($(eTo))}colIndex++});table.trigger("reordered",[f,d]).trigger("changed");table.trigger("change")}$.fn.advancedTable=function(d){let el=$(this);if(d=="reset"){el.store().reset();return}function g(j,h){if(j.hasClass("advanced-table")){return}j.on("change",function(){$(this).store().store()});if(!j.prop("id")){j.prop("advanced-table")}let children=j.find("thead > tr:first").children();$(children).each(function(k){if(!$(this).prop("id")){$(this).prop("id","advanced-table-"+k)}$(this).addClass("advanced-table-action-column")});j.after('<div class="advanced-table-header-indicator"></div>').after('<div class="advanced-table-position-indicator"></div>').after('<div class="advanced-table-resizer"></div>');j.find("th,td").each(function(){if(!$(this).parents("table").parents("table").length){$(this).wrapInner('<span class="advanced-table-resizer-span"></span>')}});j.addClass("advanced-table")}function f(j,h){if(h){for(let i=0;i<h.length;i++){let col=h[h.length-i-1];c($(col.id),$(j).find("thead tr:first th:first"));a($(col.id),Number(col.width))}}}g(el,d);f(el,el.store().load());return this};$(document).on("mouseover","table.advanced-table thead tr:first th",function(d){let table=$(this).parents("table");if(!table.data("action")){d.preventDefault();if(b(d)){$(this).addClass("resizing");$(document.body).css("cursor","col-resize")}else{$(this).removeClass("resizing");$(document.body).css("cursor","inherit")}}});$(document).on("mousedown","table.advanced-table thead tr:first th",function(d){let target=$(this);if(target.hasClass("resizing")){let table=target.parents("table");table.data("action","resizing");if(target!=null){d.preventDefault();target.addClass("resizing-move");$(document.body).css("cursor","col-resize").noSelect(true);$(document.body).data("resizable-column",target)}}}).on("mousemove",function(d){let el=$(document.body).data("resizable-column");if(el){$(document.body).css("cursor","col-resize");let table=$(el).parents("table");table.next().css({height:table.height()+"px",top:table.position().top+"px"});if(el.position().left+10>=(d.pageX-table.offset().left)){$(table).next().css({left:(el.position().left+10)+"px"})}else{$(table).next().css({left:(d.pageX-table.offset().left)+"px"})}}}).on("mouseup",function(d){let el=$(document.body).data("resizable-column");if(el){let table=$(el).parents("table");table.data("action",null);let width=d.pageX-el.offset().left;a(el,width);$(table).next().css({height:"0px",top:0,left:0});el.removeClass("resizing").removeClass("resizing-move");$(document.body).css("cursor","inherit").noSelect(false);$(document.body).data("resizable-column",null);table.trigger("resized",[el]).trigger("changed");table.trigger("change")}});$(document).on("mousedown","table.advanced-table thead tr:first th",function(d){if($(this).hasClass("resizing")){return false}$(document.body).css("cursor","move").noSelect(true);let th=$(this);th.addClass("reordering");let table=$(this).parents("table");let positionIndicator=table.next().next();let headerIndicator=table.next().next().next();table.data("action","reordering");headerIndicator.css({width:$(th).outerWidth(),height:$(th).outerHeight(),left:$(th).position().left,top:$(th).position().top+$(th).outerHeight(),lineHeight:$(th).outerHeight()+"px",visibility:"visible"}).html($(th).text()).data("col",th);positionIndicator.css({visibility:"visible",left:$(th).position().left-10,top:$(th).position().top-10});$(document.body).data("reordering-column",$(th))}).on("mousemove",function(d){let el=$(document.body).data("reordering-column");if(el){let target=$(d.target);if(target.parents("table.advanced-table").length&&target.parents("thead").length){if(target.parents("th").length){target=target.parents("th")}else{if(target.parents("td").length){target=target.parents("td")}}if(target.hasClass("advanced-table-action-column")){$(document.body).data("reordering-target",target)}else{target=$(document.body).data("reordering-target")}}else{if($(document.body).data("reordering-target")){target=$(document.body).data("reordering-target")}else{target=null}}if(!target){return}let table=el.parents("table");let positionIndicator=table.next().next();let headerIndicator=table.next().next().next();headerIndicator.css({left:target.position().left,width:el.outerWidth()});positionIndicator.css({top:el.position().top-10,left:target.position().left-10})}}).on("mouseup",function(d){let el=$(document.body).data("reordering-column");if(el){$(document.body).data("reordering-target",null);let target=$(d.target);if(target.parents("table.advanced-table").length){if(target.parents("th").length){target=target.parents("th")}else{if(target.parents("td").length){target=target.parents("td")}}let table=el.parents("table");let positionIndicator=table.next().next();let headerIndicator=table.next().next().next();table.data("action",null);$(this).removeClass("reordering");$(document.body).css("cursor","inherit").noSelect(false);headerIndicator.css({visibility:"hidden"});positionIndicator.css({visibility:"hidden"});c(headerIndicator.data("col"),target);$(document.body).data("reordering-column",null)}}});$.fn.noSelect=function(k){var f=(k===null)?true:k;var j=navigator.userAgent.indexOf("MSIE")>-1||!!window.navigator.userAgent.match(/Trident.*rv\:11\./);var d=navigator.userAgent.indexOf("Firefox")>-1;var g=navigator.userAgent.indexOf("Safari")>-1;var h=navigator.userAgent.indexOf("Presto")>-1;if(f){return this.each(function(){if(j||g){$(this).on("selectstart",false)}else{if(d){$(this).css("MozUserSelect","none");$("body").trigger("focus")}else{if(h){$(this).on("mousedown",false)}else{$(this).attr("unselectable","on")}}}})}else{return this.each(function(){if(j||g){$(this).off("selectstart")}else{if(d){$(this).css("MozUserSelect","inherit")}else{if(h){$(this).off("mousedown")}else{$(this).removeAttr("unselectable")}}}})}}})();